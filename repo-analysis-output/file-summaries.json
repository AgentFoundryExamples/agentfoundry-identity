{
  "schema_version": "2.0",
  "total_files": 30,
  "files": [
    {
      "schema_version": "2.0",
      "path": "af_identity_service/__init__.py",
      "language": "Python",
      "role": "module-init",
      "role_justification": "module initialization file '__init__'",
      "metrics": {
        "size_bytes": 1088,
        "loc": 5,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/app.py",
      "language": "Python",
      "role": "entry-point",
      "role_justification": "common entry point name 'app'",
      "metrics": {
        "size_bytes": 9299,
        "loc": 194,
        "todo_count": 0,
        "declaration_count": 4
      },
      "structure": {
        "declarations": [
          "class RequestIDMiddleware",
          "function create_health_router",
          "function create_app",
          "function main"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "typing.Any",
            "uuid"
          ],
          "third-party": [
            "fastapi.APIRouter",
            "fastapi.FastAPI",
            "fastapi.responses.JSONResponse",
            "uvicorn"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/config.py",
      "language": "Python",
      "role": "configuration",
      "role_justification": "configuration file name 'config'",
      "metrics": {
        "size_bytes": 6695,
        "loc": 142,
        "todo_count": 0,
        "declaration_count": 3
      },
      "structure": {
        "declarations": [
          "class Settings",
          "class ConfigurationError",
          "function get_settings"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "functools.lru_cache",
            "typing.Literal"
          ],
          "third-party": [
            "pydantic.Field",
            "pydantic.field_validator",
            "pydantic_settings.BaseSettings",
            "pydantic_settings.SettingsConfigDict"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/dependencies.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 14762,
        "loc": 304,
        "todo_count": 0,
        "declaration_count": 7
      },
      "structure": {
        "declarations": [
          "class SessionStore",
          "class InMemorySessionStore",
          "class GitHubDriver",
          "class PlaceholderGitHubDriver",
          "class DependencyContainer",
          "function get_dependencies",
          "function reset_dependencies"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "abc.ABC",
            "abc.abstractmethod",
            "typing.Any",
            "typing.TYPE_CHECKING"
          ],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/github/__init__.py",
      "language": "Python",
      "role": "module-init",
      "role_justification": "module initialization file '__init__'",
      "metrics": {
        "size_bytes": 1190,
        "loc": 8,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/github/driver.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 7535,
        "loc": 151,
        "todo_count": 0,
        "declaration_count": 3
      },
      "structure": {
        "declarations": [
          "class GitHubOAuthDriverError",
          "class GitHubOAuthDriver",
          "class StubGitHubOAuthDriver"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "abc.ABC",
            "abc.abstractmethod",
            "datetime.datetime",
            "datetime.timedelta",
            "datetime.timezone"
          ],
          "third-party": [
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/logging.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 5394,
        "loc": 98,
        "todo_count": 0,
        "declaration_count": 4
      },
      "structure": {
        "declarations": [
          "function add_service_context",
          "function add_request_context",
          "function configure_logging",
          "function get_logger"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "contextvars.ContextVar",
            "logging",
            "sys",
            "typing.Any"
          ],
          "third-party": [
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/models/__init__.py",
      "language": "Python",
      "role": "module-init",
      "role_justification": "module initialization file '__init__'",
      "metrics": {
        "size_bytes": 1520,
        "loc": 16,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/models/github.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 3719,
        "loc": 66,
        "todo_count": 0,
        "declaration_count": 2
      },
      "structure": {
        "declarations": [
          "class GitHubIdentity",
          "class GitHubOAuthResult"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "dataclasses.dataclass",
            "datetime.datetime",
            "datetime.timezone"
          ],
          "third-party": [
            "pydantic.BaseModel",
            "pydantic.Field"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/models/session.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 4558,
        "loc": 84,
        "todo_count": 0,
        "declaration_count": 1
      },
      "structure": {
        "declarations": [
          "class Session"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "datetime.datetime",
            "datetime.timezone",
            "uuid.UUID",
            "uuid.uuid4"
          ],
          "third-party": [
            "pydantic.BaseModel",
            "pydantic.Field",
            "pydantic.field_validator"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/models/token.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 3309,
        "loc": 57,
        "todo_count": 0,
        "declaration_count": 1
      },
      "structure": {
        "declarations": [
          "class AFTokenIntrospection"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "datetime.datetime",
            "datetime.timezone",
            "uuid.UUID"
          ],
          "third-party": [
            "pydantic.BaseModel",
            "pydantic.Field",
            "pydantic.field_validator"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/models/user.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 2975,
        "loc": 49,
        "todo_count": 0,
        "declaration_count": 1
      },
      "structure": {
        "declarations": [
          "class AFUser"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "datetime.datetime",
            "datetime.timezone",
            "uuid.UUID",
            "uuid.uuid4"
          ],
          "third-party": [
            "pydantic.BaseModel",
            "pydantic.Field"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/routes/__init__.py",
      "language": "Python",
      "role": "module-init",
      "role_justification": "module initialization file '__init__'",
      "metrics": {
        "size_bytes": 1141,
        "loc": 7,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/routes/auth_github.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 6701,
        "loc": 144,
        "todo_count": 0,
        "declaration_count": 7
      },
      "structure": {
        "declarations": [
          "class StartRequest",
          "class StartResponse",
          "class CallbackRequest",
          "class CallbackUserResponse",
          "class CallbackResponse",
          "class ErrorResponse",
          "function create_auth_github_router"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": [
            "fastapi.APIRouter",
            "fastapi.HTTPException",
            "fastapi.responses.JSONResponse",
            "pydantic.BaseModel",
            "pydantic.Field",
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/security/__init__.py",
      "language": "Python",
      "role": "module-init",
      "role_justification": "module initialization file '__init__'",
      "metrics": {
        "size_bytes": 1111,
        "loc": 7,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/security/jwt.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 4176,
        "loc": 87,
        "todo_count": 0,
        "declaration_count": 4
      },
      "structure": {
        "declarations": [
          "class JWTMintError",
          "function _base64url_encode",
          "function _create_signature",
          "function mint_af_jwt"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "base64",
            "datetime.datetime",
            "datetime.timezone",
            "hmac",
            "json",
            "uuid.UUID"
          ],
          "third-party": [
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/services/__init__.py",
      "language": "Python",
      "role": "module-init",
      "role_justification": "module initialization file '__init__'",
      "metrics": {
        "size_bytes": 1258,
        "loc": 15,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/services/oauth.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 12093,
        "loc": 256,
        "todo_count": 0,
        "declaration_count": 9
      },
      "structure": {
        "declarations": [
          "class OAuthServiceError",
          "class InvalidStateError",
          "class GitHubDriverError",
          "class StateStore",
          "class _StateEntry",
          "class InMemoryStateStore",
          "class OAuthStartResult",
          "class OAuthCallbackResult",
          "class OAuthService"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "abc.ABC",
            "abc.abstractmethod",
            "dataclasses.dataclass",
            "datetime.datetime",
            "datetime.timedelta",
            "datetime.timezone",
            "secrets",
            "threading",
            "urllib.parse.urlencode"
          ],
          "third-party": [
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/stores/__init__.py",
      "language": "Python",
      "role": "module-init",
      "role_justification": "module initialization file '__init__'",
      "metrics": {
        "size_bytes": 1515,
        "loc": 18,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/stores/github_token_store.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 9700,
        "loc": 200,
        "todo_count": 0,
        "declaration_count": 5
      },
      "structure": {
        "declarations": [
          "class GitHubTokenStoreError",
          "class RefreshTokenNotFoundError",
          "class GitHubTokenStore",
          "class _StoredTokens",
          "class InMemoryGitHubTokenStore"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "abc.ABC",
            "abc.abstractmethod",
            "datetime.datetime",
            "datetime.timezone",
            "threading",
            "uuid.UUID"
          ],
          "third-party": [
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/stores/session_store.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 8257,
        "loc": 184,
        "todo_count": 0,
        "declaration_count": 2
      },
      "structure": {
        "declarations": [
          "class SessionStore",
          "class InMemorySessionStore"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "abc.ABC",
            "abc.abstractmethod",
            "datetime.datetime",
            "datetime.timezone",
            "threading",
            "uuid.UUID"
          ],
          "third-party": [
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "af_identity_service/stores/user_store.py",
      "language": "Python",
      "role": "implementation",
      "role_justification": "general implementation file (default classification)",
      "metrics": {
        "size_bytes": 7182,
        "loc": 150,
        "todo_count": 0,
        "declaration_count": 2
      },
      "structure": {
        "declarations": [
          "class AFUserRepository",
          "class InMemoryUserRepository"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "abc.ABC",
            "abc.abstractmethod",
            "datetime.datetime",
            "datetime.timezone",
            "threading",
            "uuid.UUID"
          ],
          "third-party": [
            "structlog"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/__init__.py",
      "language": "Python",
      "role": "test",
      "role_justification": "located in 'tests' directory",
      "metrics": {
        "size_bytes": 955,
        "loc": 1,
        "todo_count": 0
      },
      "structure": {
        "declarations": []
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": []
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/test_app.py",
      "language": "Python",
      "role": "test",
      "role_justification": "filename starts with 'test_'",
      "metrics": {
        "size_bytes": 5450,
        "loc": 95,
        "todo_count": 0,
        "declaration_count": 6
      },
      "structure": {
        "declarations": [
          "function valid_settings",
          "function client",
          "class TestHealthEndpoint",
          "class TestRequestIDMiddleware",
          "class TestAppFactory",
          "class TestAPIDocumentation"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "uuid"
          ],
          "third-party": [
            "fastapi.FastAPI",
            "fastapi.testclient.TestClient",
            "pytest"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/test_auth_github_routes.py",
      "language": "Python",
      "role": "test",
      "role_justification": "filename starts with 'test_'",
      "metrics": {
        "size_bytes": 23848,
        "loc": 505,
        "todo_count": 0,
        "declaration_count": 17
      },
      "structure": {
        "declarations": [
          "function valid_settings",
          "function stub_github_driver",
          "function user_repository",
          "function session_store",
          "function token_store",
          "function state_store",
          "function oauth_service",
          "function test_client",
          "class TestMintAfJwt",
          "class TestInMemoryStateStore",
          "class TestOAuthServiceStart",
          "class TestOAuthServiceCallback",
          "class TestOAuthServiceDriverErrors",
          "class TestOAuthServiceRefreshTokenOptional",
          "class TestAuthGitHubRoutes",
          "class TestAuthGitHubRoutesDriverErrors",
          "class TestAppIntegration"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "datetime.datetime",
            "datetime.timedelta",
            "datetime.timezone",
            "unittest.mock.AsyncMock",
            "uuid.uuid4"
          ],
          "third-party": [
            "fastapi.FastAPI",
            "fastapi.testclient.TestClient",
            "pytest"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/test_config.py",
      "language": "Python",
      "role": "test",
      "role_justification": "filename starts with 'test_'",
      "metrics": {
        "size_bytes": 9530,
        "loc": 184,
        "todo_count": 0,
        "declaration_count": 2
      },
      "structure": {
        "declarations": [
          "class TestSettings",
          "class TestGetSettings"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "unittest.mock"
          ],
          "third-party": [
            "pydantic.ValidationError",
            "pytest"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/test_dependencies.py",
      "language": "Python",
      "role": "test",
      "role_justification": "filename starts with 'test_'",
      "metrics": {
        "size_bytes": 6915,
        "loc": 132,
        "todo_count": 0,
        "declaration_count": 5
      },
      "structure": {
        "declarations": [
          "function valid_settings",
          "class TestInMemorySessionStore",
          "class TestPlaceholderGitHubDriver",
          "class TestDependencyContainer",
          "class TestGetDependencies"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [],
          "third-party": [
            "pytest"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/test_github_driver.py",
      "language": "Python",
      "role": "test",
      "role_justification": "filename starts with 'test_'",
      "metrics": {
        "size_bytes": 3856,
        "loc": 57,
        "todo_count": 0,
        "declaration_count": 1
      },
      "structure": {
        "declarations": [
          "class TestStubGitHubOAuthDriver"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "datetime.datetime",
            "datetime.timezone"
          ],
          "third-party": [
            "pytest"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/test_models.py",
      "language": "Python",
      "role": "test",
      "role_justification": "filename starts with 'test_'",
      "metrics": {
        "size_bytes": 11009,
        "loc": 214,
        "todo_count": 0,
        "declaration_count": 5
      },
      "structure": {
        "declarations": [
          "class TestAFUser",
          "class TestGitHubIdentity",
          "class TestGitHubOAuthResult",
          "class TestSession",
          "class TestAFTokenIntrospection"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "dataclasses.is_dataclass",
            "datetime.datetime",
            "datetime.timedelta",
            "datetime.timezone",
            "uuid.UUID",
            "uuid.uuid4"
          ],
          "third-party": [
            "pydantic.ValidationError",
            "pytest"
          ]
        }
      }
    },
    {
      "schema_version": "2.0",
      "path": "tests/test_stores.py",
      "language": "Python",
      "role": "test",
      "role_justification": "filename starts with 'test_'",
      "metrics": {
        "size_bytes": 16355,
        "loc": 358,
        "todo_count": 0,
        "declaration_count": 3
      },
      "structure": {
        "declarations": [
          "class TestInMemoryUserRepository",
          "class TestInMemorySessionStore",
          "class TestInMemoryGitHubTokenStore"
        ]
      },
      "dependencies": {
        "imports": [],
        "exports": [],
        "external": {
          "stdlib": [
            "datetime.datetime",
            "datetime.timedelta",
            "datetime.timezone",
            "uuid.uuid4"
          ],
          "third-party": [
            "pytest"
          ]
        }
      }
    }
  ]
}